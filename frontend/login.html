<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>AI Chat Hub Sign In</title>
  <style>
    html, body { height:100%; margin:0; font-family:Arial, sans-serif; background:#f5f5f5; }
    body { display:flex; align-items:center; justify-content:center; padding:2rem; box-sizing:border-box; }
    main { width:min(420px, 100%); background:#fff; border-radius:12px; padding:2.5rem 2rem; box-shadow:0 12px 32px rgba(0,0,0,0.12); text-align:center; }
    h1 { margin:0 0 0.5rem; font-size:1.8rem; color:#1f3a63; }
    p { margin:0 0 1.75rem; color:#4f4f4f; }
    a.button { display:inline-flex; align-items:center; justify-content:center; gap:0.5rem; background:#0078d4; color:#fff; text-decoration:none; border-radius:6px; padding:0.85rem 1.5rem; font-weight:600; }
    a.button:hover { background:#005fa3; }
  </style>
</head>
<body>
  <main>
    <h1>AI Chat Hub</h1>
    <p>Sign in with your organization account to start chatting with Azure AI models.</p>
    <a class="button" href="/.auth/login/aad?post_login_redirect_uri=/chat">Sign in with Microsoft</a>
  </main>
  <script>
    async function ensureState() {
      try {
        const res = await fetch('/.auth/me');
        if (!res.ok) return;
        const data = await res.json();
        if (Array.isArray(data.clientPrincipal?.userRoles) && data.clientPrincipal.userRoles.includes('authenticated')) {
          window.location.replace('/chat');
        }
      } catch (err) {
        console.warn('Auth probe failed', err);
      }
    }
    ensureState();
  </script>
</body>
</html>
